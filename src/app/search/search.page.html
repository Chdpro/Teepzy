<ion-header class="ion-no-border">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button></ion-back-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>

  <ion-grid>


    <!--  tabs aprt -->
    <ion-row>
      <ion-col size="12">

          <div class="search">
            <span class="fa fa-search"></span>
            <input placeholder="Rechercher" #searchValue="ngModel" [(ngModel)]='search.searchValue'
              (ngModelChange)="searchOn()" name="autoComplete" [matAutocomplete]="auto">
          </div>


          <mat-autocomplete autoActiveFirstOption #auto="matAutocomplete">
            <span>
              <mat-option *ngFor="let option of listTeepZrs |myFilter:search.searchValue: ['pseudoIntime'] "
              [ngClass]="{'hide-autocomplete': !showAutocomplete}"
               [value]="option?.pseudoIntime">
                @{{option?.pseudoIntime}}
              </mat-option>
            </span>
          </mat-autocomplete>

      </ion-col>
      <!--ion-col size="12">
        <input class="input-s" 
        type="text" 
        name="search" 
        id="search"
        #searchValue="ngModel" 
        [(ngModel)]='search.searchValue'
        (ngModelChange)="searchOn()"
        list="search"
        placeholder="Rechercher...">
        <datalist id="search">
          <option *ngFor="let s of listTeepZrs" [value]="s?.pseudoPro">
            <option value="ee"></option>
            <option value="ee"></option>
            <option value="ee"></option>

      </datalist>
      </ion-col-->
    </ion-row>
    <ion-row *ngIf="search.searchValue.length == 0">
      <ion-col size="12">
        <h4>
          Ce que vous avez peut-etre manqué
        </h4>
      </ion-col>
    </ion-row>
    <!--ion-row>
      <ion-col size="6">
        <mat-card class="example-card">
          <mat-card-header>
          </mat-card-header>
          <mat-card-content class="feed-card-content"  class="mat-c">
          
            <p [ngStyle]="{'margin-top': '62px',
            'background':' #00000042', 
            'color':'white' }" class="mat-p">

            content oui je le conçois encorebiee encore et cnonre
           </p>
            <div class="video-container" >
                <video #videoPlayer playsinline preload="metadata">
                  <source [src]="sanitizer.bypassSecurityTrustResourceUrl( testVideos[0] + '#t=0.5')" type="video/mp4" />
                </video>
            </div>

          </mat-card-content>
          <mat-card-actions>
            <ion-grid>
              <ion-row>
                <ion-col size="4">
                  <div>
                                    
                      <div class="round-img-post2">
                      c
                    </div>
                  </div>
                </ion-col>
                <ion-col class="pseudo-txt">
                <span>
                  test
                </span>
                </ion-col>
              </ion-row>
            </ion-grid>


          </mat-card-actions>
        </mat-card>

      </ion-col>
    </ion-row-->
    <ion-row *ngIf="search?.searchValue.length == 0">
      <ion-col size="6" *ngFor="let lt of posts ;trackBy: trackByFn" (click)="goToDetailTeepz(lt?._id)">
        <mat-card class="example-card">
          <mat-card-header>
            <img class="mat-header-img" mat-card-image *ngIf="lt?.image_url != ''" [src]="lt?.image_url" alt="">
          </mat-card-header> 
          <mat-card-content class="feed-card-content" [ngStyle]="{'color': lt?.backgroundColor == '#fff' ? 'black' : 'white',
             'background':  lt?.image_url != '' ? '' : lt?.backgroundColor, 
             'background-position': 'center center', 'background-size': '100%',
             'background-repeat': 'no-repeat' }">
            <p [ngStyle]="{'margin-top': lt?.content.length < 25 ? '62px' : '0',
             'background': lt?.image_url != ''? ' #00000042': '', 
             'color': lt?.image_url != '' ? 'white' : '' }" class="mat-p">

              {{lt?.content}}
            </p>
            <div class="video-container" *ngIf="lt?.video_url">
              <video #videoPlayer playsinline preload="metadata">
                <source [src]="sanitizer.bypassSecurityTrustResourceUrl(lt?.video_url + '#t=0.5')" type="video/mp4" />
              </video>
              <span class="material-icons featured_video">
                featured_video
              </span>
            </div>

          </mat-card-content>
          <mat-card-actions>
            <ion-grid>
              <ion-row>
                <ion-col size="4">
                  <div>
                    <img *ngIf="lt?.userPhoto_url" class="round-img-post-miss" [src]="lt?.userPhoto_url" alt="">

                    <div *ngIf="lt?.userPhoto_url =='' || lt?.userPhoto_url == null" class="round-img-post2">
                      {{lt?.userPseudo | slice:0:1| uppercase}}
                    </div>
                  </div>
                </ion-col>
                <ion-col class="pseudo-txt">
                  <strong>
                    {{lt?.userPseudo}}
                  </strong>
                  <small>
                    {{lt?.circle || '' }}
                  </small><br>
                  <span *ngIf="time(lt?.createdAt) != 'il y a un mois'">
                    <span *ngIf="time(lt?.createdAt) != 'il y a un jour'">
                      <span *ngIf="time(lt?.createdAt) != 'il y a une minute'">
                        <span class="time" *ngIf="time(lt?.createdAt) != 'il y a une heure'">
                          {{time(lt?.createdAt) }}
                        </span>
                      </span>
                    </span>
                  </span>
                  <span class="time" *ngIf="time(lt?.createdAt) == 'il y a une minute'">
                    il y a 1 minute
                  </span>
                  <span class="time" *ngIf="time(lt?.createdAt) == 'il y a une heure'">
                    il y a 1 heure
                  </span>
                  <span class="time" *ngIf="time(lt?.createdAt) == 'il y a un jour'">
                    il y a 1 jour
                  </span>
                  <span class="time" *ngIf="time(lt?.createdAt) == 'il y a un mois'">
                    il y a 1 mois
                  </span>

                </ion-col>
              </ion-row>
            </ion-grid>


          </mat-card-actions>
        </mat-card>

      </ion-col>
      <ion-col size="12">
        <h4 class="n-found" *ngIf="posts?.length == 0">
          Aucun résultat de recherche
        </h4>
      </ion-col>

    </ion-row>

    <ion-row *ngIf="search.searchValue.length != 0">
      <ion-col size="12">
        <div class="mat-content" (touchstart)="swipe2($event, 'start')" (touchend)="swipe2($event, 'end')">
          <mat-tab-group [(selectedIndex)]="selectedTab" color="warn" mat-align-tabs="center">
            <mat-tab label="Personnes">

              <label>
                Amis
              </label><br>
              <h4 class="n-found" *ngIf="users?.length == 0 && !loading ">
                Aucun résultat de recherche
              </h4>
              <ion-spinner *ngIf="loading" color="primary" name="dots"></ion-spinner>
              <div *ngFor="let c of users | slice: lowValueT : highValueT  ;trackBy: trackByFn " (click)="goToProfile(c?._id)">
                <ion-item>
                  <div *ngIf="c?.photo == null || c?.photo == ''" class="round-img-post">
                    {{c?.pseudoIntime | slice:0:1| uppercase}}
                  </div>
                  <img *ngIf="c?.photo" class="round-img-user" [src]="c?.photo" alt="">
                  <ion-label class="p-seudo">
                    <span>
                      {{ c?.pseudoIntime }}
                    </span>
                    <p>
                      {{ c?.circleMembersCount }} Contact <span class="s-text" *ngIf="c?.circleMembersCount > 1">s</span>
                    </p>
                  </ion-label>
                </ion-item>
              </div>

              <div>
                <label>
                  Ajouter des amis
                </label>
                <div *ngFor="let c of listTeepzrsToInvite | slice: lowValueT : highValueT  ;trackBy: trackByFn ">

                  <ion-item>
                    <div *ngIf="c?.photo == null || c?.photo == ''" class="round-img-post">
                      {{c?.pseudoIntime | slice:0:1| uppercase}}
                    </div>
                    <img *ngIf="c?.photo" class="round-img-user" [src]="c?.photo" alt="">

                    <ion-label class="p-seudo"> {{ c?.pseudoIntime }}
                      <p>
                        {{ c?.circleMembersCount }} Contact <span class="s-text" *ngIf="c?.circleMembersCount > 1">s</span>
                      </p>
                    </ion-label>

                    <ion-button *ngIf="c?.invited == false" (click)="sendInvitationToJoinCircle(c?._id)" size="small">
                      <span>
                        Inviter
                      </span>
                      <!--ion-spinner *ngIf="loading" color="primary" name="dots"></ion-spinner-->
                    </ion-button>
                    <button class="cancel-btn" *ngIf="c?.invited" (click)="cancelInvitationToJoinCircle(c)"
                      mat-stroked-button>Annuler</button>

                  </ion-item>


                </div>
              </div>



              <ion-spinner *ngIf="loading" color="primary" name="dots"></ion-spinner>

              <h4 class="n-found" *ngIf="listTeepzrsToInvite?.length == 0 && !loading ">
                Aucun résultat de recherche
              </h4>

            </mat-tab>
            <mat-tab label="Publications">

              <ion-grid>
                <ion-row>
                  <ion-col size="6" *ngFor="let lt of posts ;trackBy: trackByFn" (click)="goToDetailTeepz(lt?._id)">
                    <mat-card class="example-card">
                      <mat-card-header>
                      </mat-card-header>
                      <mat-card-content class="feed-card-content" [ngStyle]="{'color': lt?.backgroundColor == '#fff' ? 'black' : 'white',
                         'background':  lt?.image_url != '' ? 'url(' + lt?.image_url + ')' : lt?.backgroundColor, 
                         'background-position': 'center center', 'background-size': '100%',
                         'background-repeat': 'no-repeat' }">
                        <p [ngStyle]="{'margin-top': lt?.content.length < 25 ? '62px' : '0',
                         'background': lt?.image_url != ''? ' #00000042': '', 
                         'color': lt?.image_url != '' ? 'white' : '' }" class="mat-p">

                          {{lt?.content}}
                        </p>
                        <div class="video-container-s" *ngIf="lt?.video_url">
                          <video #videoPlayer playsinline preload="metadata">
                            <source [src]="sanitizer.bypassSecurityTrustResourceUrl(lt?.video_url + '#t=0.5')"
                              type="video/mp4" />
                          </video>
                          <span class="material-icons featured_video">
                            featured_video
                          </span>
                        </div>

                      </mat-card-content>
                      <mat-card-actions>
                        <ion-grid>
                          <ion-row>
                            <ion-col size="4">
                              <div>
                                <img *ngIf="lt?.userPhoto_url" class="round-img-post-miss" [src]="lt?.userPhoto_url"
                                  alt="">


                                <div *ngIf="lt?.userPhoto_url =='' || lt?.userPhoto_url == null"
                                  class="round-img-post2">
                                  {{lt?.userPseudo | slice:0:1| uppercase}}
                                </div>
                              </div>
                            </ion-col>
                            <ion-col class="pseudo-txt">
                              <strong>
                                {{lt?.userPseudo}}
                              </strong>
                              <small>
                                {{lt?.circle || '' }}
                              </small><br>
                              <span *ngIf="time(lt?.createdAt) != 'il y a un mois'">
                                <span *ngIf="time(lt?.createdAt) != 'il y a un jour'">
                                  <span *ngIf="time(lt?.createdAt) != 'il y a une minute'">
                                    <span class="time" *ngIf="time(lt?.createdAt) != 'il y a une heure'">
                                      {{time(lt?.createdAt) }}
                                    </span>
                                  </span>
                                </span>
                              </span>
                              <span class="time" *ngIf="time(lt?.createdAt) == 'il y a une minute'">
                                il y a 1 minute
                              </span>
                              <span class="time" *ngIf="time(lt?.createdAt) == 'il y a une heure'">
                                il y a 1 heure
                              </span>
                              <span class="time" *ngIf="time(lt?.createdAt) == 'il y a un jour'">
                                il y a 1 jour
                              </span>
                              <span class="time" *ngIf="time(lt?.createdAt) == 'il y a un mois'">
                                il y a 1 mois
                              </span>

                            </ion-col>
                          </ion-row>
                        </ion-grid>


                      </mat-card-actions>
                    </mat-card>

                  </ion-col>
                  <ion-col size="12">
                    <h4 class="n-found" *ngIf="posts?.length == 0">
                      Aucun résultat de recherche
                    </h4>
                  </ion-col>

                </ion-row>
              </ion-grid>

            </mat-tab>
            <mat-tab label="Projets">

              <ion-grid>
                <ion-row>
                  <ion-col size="6" *ngFor="let lt of projects;trackBy: trackByFn " (click)="goToDetailProject(lt)">
                    <mat-card class="example-card">
                      <mat-card-header>
                      </mat-card-header>

                      <mat-card-content style="background: rgba(255, 255, 255, 0);" [ngStyle]="{
                        'background': 'url(' + lt?.photo + ')', 
                        'background-position': 'cover', 'background-size': '100%',
                        'background-repeat': 'no-repeat' }">
                      </mat-card-content>
                      <mat-card-actions>
                        <ion-grid>
                          <ion-row>
                            <ion-col size="2">
                              <div>
                                <img *ngIf="lt?.userPhoto_url" class="round-img-post-miss" [src]="lt?.userPhoto_url"
                                alt="">

                                <div *ngIf="lt?.userPhoto_url =='' || lt?.userPhoto_url == null" class="round-img-post2">
                                  {{lt?.userPseudo | slice:0:1| uppercase}}
                                </div>
                              </div>
                            </ion-col>
                            <ion-col size="12">
                              <strong>
                                {{lt?.nom}}
                              </strong><br>
                              <small>
                                {{lt?.circle || '' }}
                              </small>


                            </ion-col>
                            <ion-col size="12">
                              <span class="time"
                                *ngIf="(time(lt?.createdAt) != 'il y a une heure') ||(time(lt?.createdAt) == 'il y a un an') || (time(lt?.createdAt) == 'il y a un mois') || (time(lt?.createdAt) == 'il y a une semaine') || (time(lt?.createdAt) == 'il y a un jour') ">
                                {{time(lt?.createdAt) }}
                              </span>
                              <span class="time" *ngIf="time(lt?.createdAt) == 'il y a une heure'">
                                il y a 1 heure
                              </span>
                              <span class="time" *ngIf="time(lt?.createdAt) == 'il y a un jour'">
                                il y a 1 jour
                              </span>
                            </ion-col>
                          </ion-row>
                        </ion-grid>


                      </mat-card-actions>
                    </mat-card>
                  </ion-col>
                  <ion-col size="12">
                    <h4 class="n-found" *ngIf="projects?.length == 0">
                      Aucun résultat de recherche
                    </h4>
                  </ion-col>

                </ion-row>
              </ion-grid>

            </mat-tab>
            <mat-tab label="Boutiques">
              <ion-grid>
                <ion-row>
                  <ion-col size="6" *ngFor="let lt of products;trackBy: trackByFn " (click)="goToDetailProduct(lt)">
                    <mat-card class="example-card">
                      <mat-card-header>
                      </mat-card-header>

                      <mat-card-content style="background: rgba(255, 255, 255, 0);" [ngStyle]="{
             'background': 'url(' + lt?.photo + ')', 
             'background-position': 'cover', 'background-size': '100%',
             'background-repeat': 'no-repeat' }">
                      </mat-card-content>
                      <mat-card-actions>
                        <ion-grid>
                          <ion-row>
                            <ion-col size="2">
                              <div>
                                <img *ngIf="lt?.userPhoto_url" class="round-img-post-miss" [src]="lt?.userPhoto_url"
                                alt="">

                                <div *ngIf="lt?.userPhoto_url =='' || lt?.userPhoto_url == null" class="round-img-post2">
                                  {{lt?.userPseudo | slice:0:1| uppercase}}
                                </div>
                              </div>
                            </ion-col>
                            <ion-col size="12">
                              <strong>
                                {{lt?.nom}}
                              </strong>

                            </ion-col>
                            <ion-col size="12">
                              <span class="time"
                                *ngIf="(time(lt?.createdAt) != 'il y a une heure') ||(time(lt?.createdAt) == 'il y a un an') || (time(lt?.createdAt) == 'il y a un mois') || (time(lt?.createdAt) == 'il y a une semaine') || (time(lt?.createdAt) == 'il y a un jour') ">
                                {{time(lt?.createdAt) }}
                              </span>
                              <span class="time" *ngIf="time(lt?.createdAt) == 'il y a une heure'">
                                il y a 1 heure
                              </span>
                              <span class="time" *ngIf="time(lt?.createdAt) == 'il y a un jour'">
                                il y a 1 jour
                              </span>

                            </ion-col>
                          </ion-row>
                        </ion-grid>


                      </mat-card-actions>
                    </mat-card>
                  </ion-col>
                  <ion-col size="12">
                    <h4 class="n-found" *ngIf="products?.length == 0">
                      Aucun résultat de recherche
                    </h4>
                  </ion-col>

                </ion-row>
              </ion-grid>


            </mat-tab>
          </mat-tab-group>
        </div>
      </ion-col>

    </ion-row>
  </ion-grid>


</ion-content>